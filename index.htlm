<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thai Consonant Drill</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    body { margin: 0; padding: 24px; background: #0b1020; color: #e9eefc; }
    .wrap { max-width: 900px; margin: 0 auto; }
    h1 { margin: 0 0 12px; font-size: 22px; font-weight: 700; }
    .row { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; margin: 12px 0; }
    select, button { padding: 10px 12px; border-radius: 10px; border: 1px solid #2a3559; background: #121a33; color: #e9eefc; }
    button { cursor: pointer; }
    button.primary { background: #2d5bff; border-color: #2d5bff; }
    button:disabled { opacity: .5; cursor: not-allowed; }
    .card {
      background: #0f1730;
      border: 1px solid #243055;
      border-radius: 16px;
      padding: 18px;
      margin-top: 12px;
    }
    .big {
      font-size: 120px;
      line-height: 1;
      text-align: center;
      margin: 8px 0 12px;
      user-select: none;
    }
    .meta { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .pill { display:inline-block; padding: 6px 10px; border-radius: 999px; background: #141f40; border: 1px solid #27345d; font-size: 13px; }
    .choices { display: grid; gap: 10px; margin-top: 12px; }
    .choice {
      text-align: left;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid #2a3559;
      background: #121a33;
    }
    .choice.correct { border-color: #2bd97c; background: rgba(43,217,124,.12); }
    .choice.wrong { border-color: #ff4d4d; background: rgba(255,77,77,.12); }
    .small { font-size: 13px; opacity: .85; }
    .stats { display:flex; flex-wrap: wrap; gap: 10px; margin-top: 10px; }
    a { color: #8ab4ff; }
  </style>
</head>
<body>
<div class="wrap">
  <h1>Thai Consonant Drill</h1>
  <div class="small">Shortcuts: <b>Space</b> = reveal/next, <b>1–4</b> = choose.</div>

  <div class="row">
    <label class="pill">Mode:
      <select id="mode">
        <option value="flash">Flash (reveal)</option>
        <option value="mc">Multiple choice</option>
      </select>
    </label>

    <label class="pill">Class:
      <select id="klass">
        <option value="all">All</option>
        <option value="mid">Mid (อักษรกลาง)</option>
        <option value="high">High (อักษรสูง)</option>
        <option value="low">Low (อักษรต่ำ)</option>
      </select>
    </label>

    <button class="primary" id="nextBtn">Next</button>
    <button id="revealBtn">Reveal</button>
    <button id="resetBtn">Reset stats</button>
  </div>

  <div class="card">
    <div id="prompt" class="big">ก</div>

    <div class="meta">
      <div>
        <div class="pill">Name: <span id="name">—</span></div>
      </div>
      <div>
        <div class="pill">Class: <span id="classOut">—</span></div>
      </div>
      <div>
        <div class="pill">RTGS: <span id="rtgs">—</span></div>
      </div>
      <div>
        <div class="pill">Hint word: <span id="hint">—</span></div>
      </div>
    </div>

    <div id="choices" class="choices" style="display:none;"></div>

    <div class="stats">
      <div class="pill">Correct: <span id="correct">0</span></div>
      <div class="pill">Wrong: <span id="wrong">0</span></div>
      <div class="pill">Accuracy: <span id="acc">0%</span></div>
      <div class="pill">Streak: <span id="streak">0</span></div>
    </div>
  </div>

  <div class="small" style="margin-top: 14px;">
    Tip: Start with <b>Mid</b> class until it’s automatic, then expand.
  </div>
</div>

<script>
/**
 * Minimal dataset: Thai consonants with:
 * - ch: letter
 * - name: consonant name
 * - rtgs: rough RTGS / Latin cue (not perfect phonetics)
 * - hint: common hint word
 * - klass: mid/high/low
 *
 * You can expand this list easily.
 */
const CONSONANTS = [
  // Mid class (อักษรกลาง)
  { ch:"ก", name:"กอ ไก่", rtgs:"ko kai", hint:"ไก่", klass:"mid" },
  { ch:"จ", name:"จอ จาน", rtgs:"cho chan", hint:"จาน", klass:"mid" },
  { ch:"ฎ", name:"ฎอ ชฎา", rtgs:"do chada", hint:"ชฎา", klass:"mid" },
  { ch:"ฏ", name:"ฏอ ปฏัก", rtgs:"to patak", hint:"ปฏัก", klass:"mid" },
  { ch:"ด", name:"ดอ เด็ก", rtgs:"do dek", hint:"เด็ก", klass:"mid" },
  { ch:"ต", name:"ตอ เต่า", rtgs:"to tao", hint:"เต่า", klass:"mid" },
  { ch:"บ", name:"บอ ใบไม้", rtgs:"bo baimai", hint:"ใบไม้", klass:"mid" },
  { ch:"ป", name:"ปอ ปลา", rtgs:"po pla", hint:"ปลา", klass:"mid" },
  { ch:"อ", name:"ออ อ่าง", rtgs:"o ang", hint:"อ่าง", klass:"mid" },

  // High class (อักษรสูง)
  { ch:"ข", name:"ขอ ไข่", rtgs:"kho khai", hint:"ไข่", klass:"high" },
  { ch:"ฉ", name:"ฉอ ฉิ่ง", rtgs:"cho ching", hint:"ฉิ่ง", klass:"high" },
  { ch:"ฐ", name:"ฐอ ฐาน", rtgs:"tho than", hint:"ฐาน", klass:"high" },
  { ch:"ถ", name:"ถอ ถุง", rtgs:"tho thung", hint:"ถุง", klass:"high" },
  { ch:"ผ", name:"ผอ ผึ้ง", rtgs:"pho phueng", hint:"ผึ้ง", klass:"high" },
  { ch:"ฝ", name:"ฝอ ฝา", rtgs:"fo fa", hint:"ฝา", klass:"high" },
  { ch:"ศ", name:"ศอ ศาลา", rtgs:"so sala", hint:"ศาลา", klass:"high" },
  { ch:"ษ", name:"ษอ ฤๅษี", rtgs:"so rue-si", hint:"ฤๅษี", klass:"high" },
  { ch:"ส", name:"สอ เสือ", rtgs:"so suea", hint:"เสือ", klass:"high" },
  { ch:"ห", name:"หอ หีบ", rtgs:"ho hip", hint:"หีบ", klass:"high" },

  // Low class (อักษรต่ำ) – sample subset
  { ch:"ค", name:"คอ ควาย", rtgs:"kho khwai", hint:"ควาย", klass:"low" },
  { ch:"ง", name:"งอ งู", rtgs:"ngo ngu", hint:"งู", klass:"low" },
  { ch:"ช", name:"ชอ ช้าง", rtgs:"cho chang", hint:"ช้าง", klass:"low" },
  { ch:"ซ", name:"ซอ โซ่", rtgs:"so so", hint:"โซ่", klass:"low" },
  { ch:"ท", name:"ทอ ทหาร", rtgs:"tho thahan", hint:"ทหาร", klass:"low" },
  { ch:"น", name:"นอ หนู", rtgs:"no nu", hint:"หนู", klass:"low" },
  { ch:"พ", name:"พอ พาน", rtgs:"pho phan", hint:"พาน", klass:"low" },
  { ch:"ม", name:"มอ ม้า", rtgs:"mo ma", hint:"ม้า", klass:"low" },
  { ch:"ย", name:"ยอ ยักษ์", rtgs:"yo yak", hint:"ยักษ์", klass:"low" },
  { ch:"ร", name:"รอ เรือ", rtgs:"ro ruea", hint:"เรือ", klass:"low" },
  { ch:"ล", name:"ลอ ลิง", rtgs:"lo ling", hint:"ลิง", klass:"low" },
  { ch:"ว", name:"วอ แหวน", rtgs:"wo waen", hint:"แหวน", klass:"low" },
];

const $ = (id) => document.getElementById(id);

let state = {
  pool: CONSONANTS.slice(),
  current: null,
  revealed: false,
  mode: "flash",
  klass: "all",
  stats: { correct: 0, wrong: 0, streak: 0, total: 0 }
};

function filteredPool() {
  if (state.klass === "all") return CONSONANTS;
  return CONSONANTS.filter(x => x.klass === state.klass);
}

function shuffle(arr) {
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function pickNext() {
  const pool = filteredPool();
  if (!pool.length) return null;
  return pool[Math.floor(Math.random() * pool.length)];
}

function setRevealed(on) {
  state.revealed = on;
  $("name").textContent = on ? state.current.name : "—";
  $("classOut").textContent = on ? classLabel(state.current.klass) : "—";
  $("rtgs").textContent = on ? state.current.rtgs : "—";
  $("hint").textContent = on ? state.current.hint : "—";
}

function classLabel(k) {
  if (k === "mid") return "Mid (อักษรกลาง)";
  if (k === "high") return "High (อักษรสูง)";
  if (k === "low") return "Low (อักษรต่ำ)";
  return k;
}

function updateStatsUI() {
  const {correct, wrong} = state.stats;
  const total = correct + wrong;
  const acc = total ? Math.round((correct / total) * 100) : 0;
  $("correct").textContent = correct;
  $("wrong").textContent = wrong;
  $("acc").textContent = `${acc}%`;
  $("streak").textContent = state.stats.streak;
}

function renderModeUI() {
  const mc = (state.mode === "mc");
  $("choices").style.display = mc ? "grid" : "none";
  $("revealBtn").disabled = mc; // in MC, reveal comes after answering
}

function newQuestion() {
  state.current = pickNext();
  $("prompt").textContent = state.current ? state.current.ch : "—";
  setRevealed(false);

  if (state.mode === "mc") {
    renderChoices();
  } else {
    $("choices").innerHTML = "";
  }
}

function renderChoices() {
  const correct = state.current;
  const pool = filteredPool().filter(x => x.ch !== correct.ch);
  const distractors = shuffle(pool).slice(0, 3);
  const options = shuffle([correct, ...distractors]);

  $("choices").innerHTML = "";
  options.forEach((opt, idx) => {
    const btn = document.createElement("button");
    btn.className = "choice";
    btn.textContent = `${idx+1}. ${opt.name}`;
    btn.onclick = () => handleAnswer(opt.ch === correct.ch, btn, correct);
    $("choices").appendChild(btn);
  });
}

function handleAnswer(isCorrect, clickedBtn, correctObj) {
  // lock buttons
  [...$("choices").querySelectorAll("button")].forEach(b => b.disabled = true);

  state.stats.total++;

  if (isCorrect) {
    state.stats.correct++;
    state.stats.streak++;
    clickedBtn.classList.add("correct");
  } else {
    state.stats.wrong++;
    state.stats.streak = 0;
    clickedBtn.classList.add("wrong");
    // mark the correct one
    [...$("choices").querySelectorAll("button")].forEach(b => {
      if (b.textContent.includes(correctObj.name)) b.classList.add("correct");
    });
  }

  setRevealed(true);
  updateStatsUI();
}

$("mode").addEventListener("change", (e) => {
  state.mode = e.target.value;
  renderModeUI();
  newQuestion();
});

$("klass").addEventListener("change", (e) => {
  state.klass = e.target.value;
  newQuestion();
});

$("nextBtn").addEventListener("click", () => {
  newQuestion();
});

$("revealBtn").addEventListener("click", () => {
  if (!state.current) return;
  setRevealed(!state.revealed);
});

$("resetBtn").addEventListener("click", () => {
  state.stats = { correct: 0, wrong: 0, streak: 0, total: 0 };
  updateStatsUI();
});

document.addEventListener("keydown", (e) => {
  if (e.code === "Space") {
    e.preventDefault();
    if (state.mode === "flash") {
      // toggle reveal; if already revealed, next
      if (!state.revealed) setRevealed(true);
      else newQuestion();
    } else {
      // mc: if already answered (buttons disabled), next
      const btns = [...$("choices").querySelectorAll("button")];
      if (btns.length && btns.every(b => b.disabled)) newQuestion();
    }
  }
  // 1-4 for mc answers
  if (state.mode === "mc" && ["Digit1","Digit2","Digit3","Digit4"].includes(e.code)) {
    const idx = parseInt(e.code.replace("Digit",""), 10) - 1;
    const btns = [...$("choices").querySelectorAll("button")];
    if (btns[idx] && !btns[idx].disabled) btns[idx].click();
  }
});

renderModeUI();
updateStatsUI();
newQuestion();
</script>
</body>
</html>
